// JavaScript Document
$.fn.extend({plugins_keyboard:function(j){return this.each(function(){var c=this,h={type:"xlabi.com",button:true,ordered:false,loadinit:false,event:"focus",same:false,change:"each",shadow:true,other:"xlabi.com"};$.extend(h,j);$._state||$.extend({_state:{_kb_first:true,_kb_keysort:{}},author:"xlabi.com"});var a={_init:function(){this._html._before();this._settings._set();this._fn._bindonce()},_settings:{_set:function(){this._event();this._type();this._other();this._button();this._ordered();this._same(); this._change();this._loadinit();this._shadow()},_type:function(){a._global._type=h.type;a._adjust._before()},_other:function(){a._global._other=h.other},_button:function(){if(h.button){a._html._settings._button();a._adjust._settings._button();a._event._button()}a._event._self()},_ordered:function(){a._global._ordered=h.ordered},_loadinit:function(){h.loadinit&&a._fn._set_panel()},_event:function(){a._global._event=h.event;$(document).keydown(function(b){if(b.keyCode==9){a._fn._set_all_hide();a._event._self_tabkey()}})}, _same:function(){a._global._same=h.same},_change:function(){a._global._change=h.change},_shadow:function(){a._global._shadow=h.shadow}},_global:{_key:{w:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],c:[{e:"_",s:"-"},{e:"=",s:"+"},{e:"\\",s:"|"},{e:"[",s:"{"},{e:"]",s:"}"},{e:";",s:":"},{e:"'",s:'"'},{e:",",s:"<"},{e:".",s:">"},{e:"/",s:"?"}],n:[{e:"`",s:"~"},{e:1,s:"!"},{e:2,s:"@"},{e:3,s:"#"},{e:4,s:"$"},{e:5,s:"%"},{e:6,s:"^"},{e:7,s:"&"}, {e:8,s:"*"},{e:9,s:"("},{e:0,s:")"}],num:[1,2,3,4,5,6,7,8,9,0]},_shift:"up",_capslock:"off"},_obj:{_key:{}},_html:{_before:function(){$(c).css("background-image")=="none";$(c).wrap('<div class="hs_kb_wrap"></div>');a._obj._wrap=$(c).parent(".hs_kb_wrap")},_settings:{_button:function(){a._obj._button=$('<div class="hs_kb_btn"></div>').appendTo(a._obj._wrap)},_shadow:function(){a._obj._shadow=$('<div class="hs_kb_shadow"></div>').appendTo(a._obj._wrap)}, _iframe:function(){a._obj._iframe=$('<iframe src="javascript:false"></iframe>').appendTo(a._obj._wrap)}},_after:function(){a._obj._panel=$('<div class="hs_kb_panel"></div>').appendTo(a._obj._wrap);if(a._global._type!="mini"){a._obj._key._n=$('<ul class="hs_kb_key_n"></ul>').appendTo(a._obj._panel);a._obj._key._c=$('<ul class="hs_kb_key_c"></ul>').appendTo(a._obj._panel);a._obj._key._w=$('<dl class="hs_kb_key_w"></dl>').appendTo(a._obj._panel);a._obj._close=$('<span class="hs_kb_close">exit</span>').appendTo(a._obj._panel); a._obj._backspace=$('<div class="hs_kb_backspace">\u2190</div>').appendTo(a._obj._panel);a._obj._capslock=$('<div class="hs_kb_capslock">capslock</div>').appendTo(a._obj._panel);a._obj._shift=$('<div class="hs_kb_shift">shift</div>').appendTo(a._obj._panel);a._obj._enter=$('<div class="hs_kb_enter">enter</div>').appendTo(a._obj._panel)}else{if(a._global._other=="mini2"){a._obj._close=$('<span class="hs_kb_close">exit</span>').appendTo(a._obj._panel);a._obj._backspace=$('<div class="hs_kb_backspace">\u2190</div>').appendTo(a._obj._panel)}else a._obj._enter= $('<div class="hs_kb_enter">enter</div>').appendTo(a._obj._panel);a._obj._key._num=$('<dl class="hs_kb_key_num"></dl>').appendTo(a._obj._panel)}}},_event:{_bind:function(){this._wrap();this._key();if(a._global._type!="mini"){this._close();this._backspace();this._capslock();this._shift();this._enter()}else if(a._global._other=="mini2"){this._close();this._backspace()}else this._enter()},_self:function(){a._global._event=="focus"&&$(c).mousedown(function(){a._fn._set_self()});a._global._event=="click"&& $(c).click(function(){a._fn._set_all_hide()})},_self_tabkey:function(){a._global._event=="focus"&&$(c).unbind("focus").focus(function(){a._fn._set_self();$(c).unbind("focus")})},_wrap:function(){a._obj._wrap.unbind("mousedown").mousedown(function(){$(c).unbind("focus");a._event._focus();return false})},_button:function(){a._obj._button.click(function(){a._fn._set_button()});a._obj._button.mousedown(function(){$(this).addClass("hs_kb_btn_down")})},_key:function(){$("ul div,dl div",a._obj._panel).unbind("click").click(function(){a._fn._set_keyval($(this))})}, _close:function(){a._obj._close.click(function(){a._fn._set_close()})},_backspace:function(){a._obj._backspace.click(function(){a._fn._set_backspace()})},_capslock:function(){a._obj._capslock.click(function(){a._fn._set_capslock($(this))})},_shift:function(){a._obj._shift.click(function(){a._fn._set_shift($(this))})},_enter:function(){a._obj._enter.click(function(){a._fn._set_enter()})},_focus:function(){$(c).focus();if($.browser.msie){var b=$(c)[0],d=b.createTextRange();d.moveStart("character",b.value.length); d.collapse(true);d.select()}}},_adjust:{_v:{pos:{p:{t:0,r:0,b:0,l:0},pts:{t:2,r:2,b:2,l:2}}},_before:function(){$(c).css("float","left");a._obj._wrap.css({border:[$(c).css("border-bottom-style"),$(c).css("border-bottom-color"),$(c).css("border-bottom-width")].join(" ")});$(c).css({border:"0 none",margin:0});a._global._self_h=a._obj._wrap.outerHeight()-parseInt(a._obj._wrap.css("border-top-width"));a._global._type=="mini"&&a._obj._wrap.addClass("hs_kb_wrap_mini")},_settings:{_button:function(){$(c).width($(c).width()- a._obj._button.width());a._obj._button.height($(c).innerHeight())}},_after:function(){a._obj._panel.css({top:a._global._self_h});a._obj._shadow&&a._obj._shadow.css({top:a._global._self_h+2})}},_fn:{_set_panel:function(){a._html._after();a._global._shadow&&a._html._settings._shadow();if(a._global._same||a._global._change!="each")a._fn._set_keysort();a._event._bind();a._adjust._after()},_set_ckey:function(b,d){return"<li><div><em>"+b+"</em><sup>"+d+"</sup></div></li>"},_set_wkey:function(b){return"<dd><div>"+ b+"</div></dd>"},_set_keysort:function(){$("ul,dl",a._obj._panel).empty();a._global._type!="mini"&&a._fn._reset_shift_capslock();if(a._global._type!="mini"){if(!$._state._kb_keysort._normalkb){var b=[],d=[],i=[];$.each(a._fn._get_sort_array(a._global._key.n),function(f,e){i[f]=a._fn._set_ckey(e.e,e.s)});$.each(a._fn._get_sort_array(a._global._key.c),function(f,e){b[f]=a._fn._set_ckey(e.e,e.s)});$.each(a._fn._get_sort_array(a._global._key.w),function(f,e){d[f]=a._fn._set_wkey(e)})}}else if(!$._state._kb_keysort._num){var g= [];$.each(a._fn._get_sort_array(a._global._key.num),function(f,e){g[f]=a._fn._set_wkey(e)})}if(a._global._same)if(a._global._type!="mini"){$._state._kb_keysort._normalkb=$._state._kb_keysort._normalkb||{_n:i,_c:b,_w:d};b=$._state._kb_keysort._normalkb._c;d=$._state._kb_keysort._normalkb._w;i=$._state._kb_keysort._normalkb._n}else{$._state._kb_keysort._num=$._state._kb_keysort._num||g;g=$._state._kb_keysort._num}if(a._global._type!="mini"){a._obj._key._n.append(i.join(""));a._obj._key._c.append(b.join("")); a._obj._key._w.append(d.join(""))}else a._obj._key._num.append(g.join(""))},_set_self:function(){if(!a._fn._is_show()){a._obj._panel||a._fn._set_panel();a._fn._set_all_hide();a._fn._set_show()}},_set_keyval:function(b){$(c).val(""+$(c).val()+function(d){var i=$("em",d);return i.size()==0?d.text():i.text()}(b));a._event._focus()},_set_button:function(){a._obj._panel||a._fn._set_panel();a._event._focus();a._fn._is_show()?a._fn._set_hide():a._fn._set_show()},_set_backspace:function(){var b=$(c).val(); $(c).val(b.substring(0,b.length-1));a._event._focus()},_set_shift:function(b){if(a._global._shift=="up"){a._global._shift="down";b.addClass("hs_kb_shift_down")}else{a._global._shift="up";b.removeClass("hs_kb_shift_down")}$("li div",a._obj._panel).each(function(){var d=$("em",$(this)).text();$("em",$(this)).text($("sup",$(this)).text());$("sup",$(this)).text(d)});this._set_wchange()},_reset_shift_capslock:function(){a._global._shift="up";a._global._capslock="off";a._obj._shift.removeClass("hs_kb_shift_down"); a._obj._capslock.removeClass("hs_kb_capslock_on")},_set_capslock:function(b){if(a._global._capslock=="on"){a._global._capslock="off";b.removeClass("hs_kb_capslock_on")}else{a._global._capslock="on";b.addClass("hs_kb_capslock_on")}this._set_wchange()},_set_wchange:function(){$("dd div",a._obj._panel).each(function(){var b=$(this).text();b.toLowerCase()==b?$(this).text(b.toUpperCase()):$(this).text(b.toLowerCase())});a._event._focus()},_set_close:function(){a._fn._set_hide();a._event._focus()},_set_enter:function(){a._fn._set_hide(); $(c).blur()},_set_hide:function(){a._obj._panel.hide();a._fn._set_all_hide()},_set_show:function(){a._fn._set_all_hide();a._obj._wrap.css({position:"relative"});a._obj._panel.show();if($.browser.msie&&$.browser.version=="6.0"&&!$.support.style){a._html._settings._iframe();a._obj._iframe.css({top:a._global._self_h})}if(!a._global._same)if(a._obj._panel&&a._global._change=="each"){a._fn._set_keysort();a._event._key()}a._obj._shadow&&a._obj._shadow.show()},_set_all_hide:function(){$(".hs_kb_panel,.hs_kb_shadow").hide(); $(".hs_kb_wrap iframe").remove();$(".hs_kb_wrap").css({position:"static"})},_is_show:function(){return a._obj._panel&&a._obj._panel.css("display")=="block"?true:false},_get_sort_array:function(b){var d=[],i={},g,f=b.length;if(a._global._ordered){g=parseInt(Math.random()*f);for(var e=0;e<f;e++)d[e]=g+e>=f?b[g+e-f]:b[g+e]}else for(e=0;e<f;){g=parseInt(Math.random()*f);if(!i["_"+g]){d[e++]=b[g];i["_"+g]=1}}return d},_bindonce:function(){if($._state._kb_first){$(document).bind({mousedown:function(){$(c).unbind("focus"); a._fn._set_all_hide()},mouseup:function(){$(".hs_kb_btn").removeClass("hs_kb_btn_down")}});$(".hs_kb_panel div").live("mouseover",function(){$(this).addClass("hs_kb_key_hover")});$(".hs_kb_panel div").live("mouseout",function(){$(this).removeClass("hs_kb_key_hover")});$(".hs_kb_close").live("mouseover",function(){$(this).addClass("hs_kb_close_hover")});$(".hs_kb_close").live("mouseout",function(){$(this).removeClass("hs_kb_close_hover")});$._state._kb_first=false}}}};a._init()})}});
